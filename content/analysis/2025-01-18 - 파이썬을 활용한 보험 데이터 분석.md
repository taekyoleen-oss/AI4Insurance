---
title: "파이썬을 활용한 보험 데이터 분석"
date: "2025-01-18"
category: "analysis"
excerpt: "파이썬의 강력한 데이터 분석 라이브러리를 활용하여 보험 데이터를 분석하고 시각화하는 방법을 알아보겠습니다."
tags: ["Python", "데이터분석", "시각화"]
---

보험업계에서 데이터 분석의 중요성이 커지고 있습니다. 이번 포스트에서는 파이썬을 활용한 보험 데이터 분석의 실제 사례를 단계별로 살펴보겠습니다.

## 분석 환경 설정

### 1. 필요한 라이브러리 설치
```bash
pip install pandas numpy matplotlib seaborn plotly scikit-learn
```

### 2. 기본 라이브러리 임포트
```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
```

## 데이터 로드 및 탐색

### 1. 데이터 로드
```python
# 보험 데이터 로드
df = pd.read_csv('insurance_data.csv')

# 기본 정보 확인
print("데이터 형태:", df.shape)
print("\n컬럼 정보:")
print(df.info())
print("\n기본 통계:")
print(df.describe())
```

### 2. 데이터 품질 확인
```python
# 결측값 확인
missing_data = df.isnull().sum()
print("결측값 현황:")
print(missing_data[missing_data > 0])

# 중복값 확인
duplicates = df.duplicated().sum()
print(f"\n중복 행 수: {duplicates}")

# 이상값 탐지
Q1 = df['premium'].quantile(0.25)
Q3 = df['premium'].quantile(0.75)
IQR = Q3 - Q1
outliers = df[(df['premium'] < Q1 - 1.5*IQR) | (df['premium'] > Q3 + 1.5*IQR)]
print(f"\n이상값 수: {len(outliers)}")
```

## 기본 통계 분석

### 1. 기술 통계
```python
# 연령별 보험료 분석
age_premium = df.groupby('age')['premium'].agg(['mean', 'median', 'std']).round(2)
print("연령별 보험료 통계:")
print(age_premium)

# 성별 보험료 차이
gender_premium = df.groupby('gender')['premium'].mean()
print(f"\n성별 평균 보험료:")
print(gender_premium)
```

### 2. 상관관계 분석
```python
# 수치형 변수 간 상관관계
numeric_cols = df.select_dtypes(include=[np.number]).columns
correlation_matrix = df[numeric_cols].corr()

# 히트맵으로 시각화
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0)
plt.title('보험 데이터 상관관계 히트맵')
plt.show()
```

## 시각화 분석

### 1. 분포 분석
```python
# 보험료 분포
plt.figure(figsize=(12, 5))

plt.subplot(1, 2, 1)
plt.hist(df['premium'], bins=30, alpha=0.7, color='skyblue')
plt.title('보험료 분포')
plt.xlabel('보험료')
plt.ylabel('빈도')

plt.subplot(1, 2, 2)
df['premium'].plot(kind='box')
plt.title('보험료 박스플롯')
plt.ylabel('보험료')

plt.tight_layout()
plt.show()
```

### 2. 범주형 변수 분석
```python
# 성별별 보험료 분포
plt.figure(figsize=(15, 5))

plt.subplot(1, 3, 1)
sns.boxplot(data=df, x='gender', y='premium')
plt.title('성별 보험료 분포')

plt.subplot(1, 3, 2)
sns.violinplot(data=df, x='gender', y='premium')
plt.title('성별 보험료 바이올린 플롯')

plt.subplot(1, 3, 3)
df.groupby('gender')['premium'].mean().plot(kind='bar')
plt.title('성별 평균 보험료')
plt.ylabel('평균 보험료')

plt.tight_layout()
plt.show()
```

### 3. 인터랙티브 시각화
```python
# Plotly를 활용한 인터랙티브 차트
fig = px.scatter(df, x='age', y='premium', color='gender', 
                 size='claims', hover_data=['region'])
fig.update_layout(title='연령별 보험료 분포 (인터랙티브)')
fig.show()
```

## 고급 분석 기법

### 1. 클러스터링 분석
```python
# 고객 세분화를 위한 클러스터링
features = ['age', 'premium', 'claims']
X = df[features].fillna(df[features].mean())

# 데이터 표준화
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# K-means 클러스터링
kmeans = KMeans(n_clusters=4, random_state=42)
df['cluster'] = kmeans.fit_predict(X_scaled)

# 클러스터별 특성 분석
cluster_analysis = df.groupby('cluster')[features].mean()
print("클러스터별 특성:")
print(cluster_analysis)
```

### 2. 시계열 분석
```python
# 월별 보험료 트렌드 분석
monthly_premium = df.groupby('month')['premium'].sum()

plt.figure(figsize=(12, 6))
monthly_premium.plot(kind='line', marker='o')
plt.title('월별 보험료 트렌드')
plt.xlabel('월')
plt.ylabel('총 보험료')
plt.grid(True)
plt.show()
```

## 리스크 분석

### 1. 사고율 분석
```python
# 연령대별 사고율
df['age_group'] = pd.cut(df['age'], bins=[0, 30, 40, 50, 60, 100], 
                        labels=['20대', '30대', '40대', '50대', '60대+'])

accident_rate = df.groupby('age_group')['claims'].mean()
print("연령대별 평균 사고율:")
print(accident_rate)

# 시각화
plt.figure(figsize=(10, 6))
accident_rate.plot(kind='bar', color='coral')
plt.title('연령대별 평균 사고율')
plt.xlabel('연령대')
plt.ylabel('평균 사고율')
plt.xticks(rotation=45)
plt.show()
```

### 2. 지역별 리스크 분석
```python
# 지역별 보험료와 사고율 분석
region_analysis = df.groupby('region').agg({
    'premium': 'mean',
    'claims': 'mean',
    'age': 'mean'
}).round(2)

print("지역별 분석:")
print(region_analysis)

# 산점도로 시각화
plt.figure(figsize=(10, 8))
sns.scatterplot(data=df, x='premium', y='claims', hue='region', size='age')
plt.title('지역별 보험료 vs 사고율')
plt.xlabel('평균 보험료')
plt.ylabel('평균 사고율')
plt.show()
```

## 예측 모델링

### 1. 보험료 예측 모델
```python
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

# 특성과 타겟 분리
X = df[['age', 'gender', 'region']]
y = df['premium']

# 원핫 인코딩
X_encoded = pd.get_dummies(X)

# 훈련/테스트 분할
X_train, X_test, y_train, y_test = train_test_split(X_encoded, y, test_size=0.2, random_state=42)

# 모델 훈련
model = LinearRegression()
model.fit(X_train, y_train)

# 예측 및 평가
y_pred = model.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"평균 제곱 오차: {mse:.2f}")
print(f"R² 점수: {r2:.2f}")
```

### 2. 특성 중요도 분석
```python
# 특성 중요도 시각화
feature_importance = pd.DataFrame({
    'feature': X_encoded.columns,
    'importance': model.coef_
}).sort_values('importance', ascending=False)

plt.figure(figsize=(10, 6))
sns.barplot(data=feature_importance, x='importance', y='feature')
plt.title('특성 중요도')
plt.xlabel('계수 값')
plt.show()
```

## 대시보드 구축

### 1. Streamlit 대시보드
```python
import streamlit as st

def create_dashboard():
    st.title("보험 데이터 분석 대시보드")
    
    # 사이드바 필터
    st.sidebar.header("필터")
    age_range = st.sidebar.slider("연령 범위", 18, 80, (25, 65))
    gender_filter = st.sidebar.selectbox("성별", ["전체", "남성", "여성"])
    
    # 필터링된 데이터
    filtered_df = df[(df['age'] >= age_range[0]) & (df['age'] <= age_range[1])]
    
    if gender_filter != "전체":
        filtered_df = filtered_df[filtered_df['gender'] == gender_filter]
    
    # 주요 지표
    col1, col2, col3, col4 = st.columns(4)
    
    with col1:
        st.metric("총 고객 수", len(filtered_df))
    
    with col2:
        st.metric("평균 보험료", f"{filtered_df['premium'].mean():,.0f}원")
    
    with col3:
        st.metric("평균 사고율", f"{filtered_df['claims'].mean():.2f}")
    
    with col4:
        st.metric("평균 연령", f"{filtered_df['age'].mean():.1f}세")
    
    # 차트
    st.subheader("보험료 분포")
    fig = px.histogram(filtered_df, x='premium', nbins=30)
    st.plotly_chart(fig)

if __name__ == "__main__":
    create_dashboard()
```

## 실무 적용 팁

### 1. 데이터 품질 관리
```python
def data_quality_check(df):
    """데이터 품질 체크 함수"""
    issues = []
    
    # 결측값 체크
    missing = df.isnull().sum()
    if missing.sum() > 0:
        issues.append(f"결측값 발견: {missing[missing > 0].to_dict()}")
    
    # 이상값 체크
    numeric_cols = df.select_dtypes(include=[np.number]).columns
    for col in numeric_cols:
        Q1 = df[col].quantile(0.25)
        Q3 = df[col].quantile(0.75)
        IQR = Q3 - Q1
        outliers = df[(df[col] < Q1 - 1.5*IQR) | (df[col] > Q3 + 1.5*IQR)]
        if len(outliers) > 0:
            issues.append(f"{col} 컬럼에 {len(outliers)}개 이상값 발견")
    
    return issues
```

### 2. 자동화된 보고서 생성
```python
def generate_report(df):
    """자동 보고서 생성"""
    report = {
        '총 고객 수': len(df),
        '평균 보험료': df['premium'].mean(),
        '보험료 표준편차': df['premium'].std(),
        '최고 보험료': df['premium'].max(),
        '최저 보험료': df['premium'].min(),
        '평균 사고율': df['claims'].mean()
    }
    
    return report
```

## 결론

파이썬을 활용한 보험 데이터 분석은 보험업계의 핵심 역량이 되고 있습니다.

> "데이터는 새로운 석유다. 하지만 정제되지 않은 석유는 쓸모가 없다."

앞으로 더 고급 분석 기법과 실시간 모니터링 시스템에 대해 다루어보겠습니다.
