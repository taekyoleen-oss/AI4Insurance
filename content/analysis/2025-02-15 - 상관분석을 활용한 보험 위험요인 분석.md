---
title: "상관분석을 활용한 보험 위험요인 분석"
date: "2025-02-15"
category: "analysis"
tags: ["상관분석", "위험요인", "보험분석"]
excerpt: "상관분석의 이론적 배경과 보험 위험요인 분석에서의 활용법을 살펴보고, 실무 적용 사례를 제공합니다."
---

상관분석(Correlation Analysis)은 보험업계에서 위험요인 간의 관계를 파악하는 핵심 기법입니다. 이번 포스트에서는 상관분석의 이론적 배경과 보험 위험요인 분석에서의 실무적 활용법을 자세히 살펴보겠습니다.

## 상관분석의 정의와 목적

상관분석은 두 변수 간의 선형 관계의 강도와 방향을 측정하는 통계적 방법입니다:

### 1. 상관계수의 정의

**피어슨 상관계수 (Pearson Correlation Coefficient)**:
```
r = Σ(xᵢ - x̄)(yᵢ - ȳ) / √[Σ(xᵢ - x̄)² × Σ(yᵢ - ȳ)²]
```

여기서:
- **r**: 상관계수 (-1 ≤ r ≤ 1)
- **xᵢ, yᵢ**: 관측값
- **x̄, ȳ**: 평균값

### 2. 상관계수의 해석

- **r = 1**: 완전한 양의 상관관계
- **r = 0**: 상관관계 없음
- **r = -1**: 완전한 음의 상관관계
- **|r| > 0.7**: 강한 상관관계
- **0.3 < |r| ≤ 0.7**: 중간 상관관계
- **|r| ≤ 0.3**: 약한 상관관계

## 보험업계에서의 상관분석 활용

### 1. 주요 활용 영역

- **위험요인 분석**: 보험 위험요인 간의 상관관계 파악
- **손해액 예측**: 손해액과 위험요인 간의 상관관계 분석
- **사고 빈도**: 사고 발생 빈도와 위험요인 간의 상관관계 분석
- **보험료 산출**: 보험료와 위험요인 간의 상관관계 분석

### 2. 파이썬을 활용한 상관분석

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats
from scipy.stats import pearsonr, spearmanr, kendalltau
import warnings
warnings.filterwarnings('ignore')

# 보험 데이터 생성 (예시)
np.random.seed(42)
n_samples = 1000

# 위험요인들
age = np.random.normal(35, 10, n_samples)
driving_experience = np.random.normal(10, 5, n_samples)
car_value = np.random.normal(20000, 5000, n_samples)
claims_history = np.random.poisson(2, n_samples)
weather_risk = np.random.uniform(0, 1, n_samples)

# 손해액 (위험요인들의 선형 조합 + 노이즈)
damage_amount = (1000 + 50*age - 20*driving_experience + 0.1*car_value + 
                 200*claims_history + 500*weather_risk + np.random.normal(0, 200, n_samples))

# 데이터프레임 생성
data = pd.DataFrame({
    'age': age,
    'driving_experience': driving_experience,
    'car_value': car_value,
    'claims_history': claims_history,
    'weather_risk': weather_risk,
    'damage_amount': damage_amount
})

print("보험 데이터 기본 통계:")
print(data.describe())
```

### 3. 상관계수 계산

```python
def correlation_analysis(data):
    """상관분석"""
    
    # 피어슨 상관계수
    pearson_corr = data.corr(method='pearson')
    
    # 스피어만 상관계수
    spearman_corr = data.corr(method='spearman')
    
    # 켄달 타우 상관계수
    kendall_corr = data.corr(method='kendall')
    
    print("피어슨 상관계수:")
    print(pearson_corr)
    
    print("\n스피어만 상관계수:")
    print(spearman_corr)
    
    print("\n켄달 타우 상관계수:")
    print(kendall_corr)
    
    return pearson_corr, spearman_corr, kendall_corr

# 상관분석 실행
pearson_corr, spearman_corr, kendall_corr = correlation_analysis(data)
```

### 4. 상관분석 시각화

```python
def visualize_correlation_analysis(data):
    """상관분석 시각화"""
    
    fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 12))
    
    # 상관계수 히트맵
    sns.heatmap(data.corr(), annot=True, cmap='coolwarm', center=0, ax=ax1)
    ax1.set_title('상관계수 히트맵')
    
    # 산점도 매트릭스
    sns.scatterplot(data=data, x='age', y='damage_amount', ax=ax2)
    ax2.set_title('나이 vs 손해액')
    ax2.grid(True, alpha=0.3)
    
    # 상관계수 막대그래프
    corr_with_damage = data.corr()['damage_amount'].drop('damage_amount')
    ax3.bar(corr_with_damage.index, corr_with_damage.values)
    ax3.set_title('손해액과의 상관계수')
    ax3.set_ylabel('상관계수')
    ax3.grid(True, alpha=0.3)
    
    # 상관계수 분포
    ax4.hist(data.corr().values.flatten(), bins=20, alpha=0.7)
    ax4.set_title('상관계수 분포')
    ax4.set_xlabel('상관계수')
    ax4.set_ylabel('빈도')
    ax4.grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.show()

# 상관분석 시각화 실행
visualize_correlation_analysis(data)
```

## 엑셀을 활용한 상관분석

### 1. 기본 설정

```excel
A1: 나이
B1: 운전경력
C1: 차량가격
D1: 사고이력
E1: 날씨위험
F1: 손해액

A2: =RAND()*50+20
B2: =RAND()*20+1
C2: =RAND()*30000+10000
D2: =POISSON.DIST(RAND(),2,TRUE)
E2: =RAND()
F2: =1000+50*A2-20*B2+0.1*C2+200*D2+500*E2+RAND()*400-200
```

### 2. 상관계수 계산

```excel
# 피어슨 상관계수
A5: 상관계수
A6: 나이-손해액
B6: =CORREL(A2:A1001,F2:F1001)
A7: 운전경력-손해액
B7: =CORREL(B2:B1001,F2:F1001)
A8: 차량가격-손해액
B8: =CORREL(C2:C1001,F2:F1001)
A9: 사고이력-손해액
B9: =CORREL(D2:D1001,F2:F1001)
A10: 날씨위험-손해액
B10: =CORREL(E2:E1001,F2:F1001)
```

### 3. 상관계수 해석

```excel
# 상관계수 해석
A12: 상관계수
B12: 해석
A13: =B6
B13: =IF(ABS(A13)>0.7,"강한 상관관계",IF(ABS(A13)>0.3,"중간 상관관계","약한 상관관계"))
A14: =B7
B14: =IF(ABS(A14)>0.7,"강한 상관관계",IF(ABS(A14)>0.3,"중간 상관관계","약한 상관관계"))
```

## 고급 분석 기법

### 1. 부분 상관분석

```python
def partial_correlation_analysis(data):
    """부분 상관분석"""
    
    from scipy.stats import pearsonr
    
    # 부분 상관계수 계산
    def partial_corr(x, y, z):
        # x와 y의 상관계수
        r_xy = pearsonr(x, y)[0]
        # x와 z의 상관계수
        r_xz = pearsonr(x, z)[0]
        # y와 z의 상관계수
        r_yz = pearsonr(y, z)[0]
        
        # 부분 상관계수
        r_xy_z = (r_xy - r_xz * r_yz) / np.sqrt((1 - r_xz**2) * (1 - r_yz**2))
        return r_xy_z
    
    # 나이와 손해액의 부분 상관계수 (운전경력 통제)
    partial_corr_age_damage = partial_corr(data['age'], data['damage_amount'], data['driving_experience'])
    
    print(f"나이와 손해액의 부분 상관계수 (운전경력 통제): {partial_corr_age_damage:.4f}")
    
    return partial_corr_age_damage

# 부분 상관분석 실행
partial_corr = partial_correlation_analysis(data)
```

### 2. 다중 상관분석

```python
def multiple_correlation_analysis(data):
    """다중 상관분석"""
    
    # 다중 상관계수 계산
    def multiple_corr(y, x_vars):
        # 상관계수 행렬
        corr_matrix = data[['damage_amount'] + x_vars].corr()
        
        # 다중 상관계수
        R = np.sqrt(1 - np.linalg.det(corr_matrix) / np.linalg.det(corr_matrix.iloc[1:, 1:]))
        
        return R
    
    # 위험요인들
    x_vars = ['age', 'driving_experience', 'car_value', 'claims_history', 'weather_risk']
    
    # 다중 상관계수
    multiple_R = multiple_corr(data['damage_amount'], x_vars)
    
    print(f"다중 상관계수: {multiple_R:.4f}")
    
    return multiple_R

# 다중 상관분석 실행
multiple_R = multiple_correlation_analysis(data)
```

## 실무 적용 사례

### 사례 1: 자동차보험 위험요인 분석

```python
def auto_insurance_risk_factor_analysis():
    """자동차보험 위험요인 분석"""
    
    # 실제 자동차보험 데이터 (예시)
    np.random.seed(42)
    n_samples = 2000
    
    # 위험요인들
    age = np.random.normal(35, 10, n_samples)
    driving_experience = np.random.normal(10, 5, n_samples)
    car_value = np.random.normal(20000, 5000, n_samples)
    claims_history = np.random.poisson(2, n_samples)
    weather_risk = np.random.uniform(0, 1, n_samples)
    
    # 손해액 계산
    damage_amount = (1000 + 50*age - 20*driving_experience + 0.1*car_value + 
                     200*claims_history + 500*weather_risk + np.random.normal(0, 200, n_samples))
    
    # 데이터프레임 생성
    data = pd.DataFrame({
        'age': age,
        'driving_experience': driving_experience,
        'car_value': car_value,
        'claims_history': claims_history,
        'weather_risk': weather_risk,
        'damage_amount': damage_amount
    })
    
    # 상관분석
    corr_matrix = data.corr()
    
    # 손해액과의 상관계수
    damage_corr = corr_matrix['damage_amount'].drop('damage_amount')
    
    print("자동차보험 위험요인 분석 결과:")
    for factor, corr in damage_corr.items():
        strength = "강한" if abs(corr) > 0.7 else "중간" if abs(corr) > 0.3 else "약한"
        direction = "양의" if corr > 0 else "음의"
        print(f"  {factor}: {direction} {strength} 상관관계 (r={corr:.3f})")
    
    return damage_corr

# 자동차보험 위험요인 분석 실행
risk_analysis = auto_insurance_risk_factor_analysis()
```

### 사례 2: 보험료 산출 시스템

```python
def premium_calculation_with_correlation(model, customer_data):
    """상관분석을 통한 보험료 산출 시스템"""
    
    # 위험요인별 가중치 계산
    risk_weights = {
        'age': 0.3,
        'driving_experience': -0.2,
        'car_value': 0.1,
        'claims_history': 0.4,
        'weather_risk': 0.2
    }
    
    # 위험도 점수 계산
    risk_score = sum(risk_weights[factor] * customer_data[factor] for factor in risk_weights.keys())
    
    # 기본 보험료
    base_premium = 1000
    
    # 위험도에 따른 보험료 조정
    if risk_score > 2:
        risk_multiplier = 2.0
        risk_level = "고위험"
    elif risk_score > 0:
        risk_multiplier = 1.5
        risk_level = "중위험"
    else:
        risk_multiplier = 1.0
        risk_level = "저위험"
    
    # 총 보험료 계산
    total_premium = base_premium * risk_multiplier
    
    return {
        'risk_score': risk_score,
        'risk_level': risk_level,
        'risk_multiplier': risk_multiplier,
        'base_premium': base_premium,
        'total_premium': total_premium
    }

# 보험료 산출 시스템 실행
customer_data = {
    'age': 30,
    'driving_experience': 5,
    'car_value': 25000,
    'claims_history': 1,
    'weather_risk': 0.7
}

premium_result = premium_calculation_with_correlation(risk_analysis, customer_data)
for key, value in premium_result.items():
    print(f"{key}: {value}")
```

## 상관분석의 한계와 주의사항

### 1. 상관분석의 한계

- **선형 관계**: 비선형 관계 모델링 어려움
- **인과관계**: 상관관계는 인과관계를 의미하지 않음
- **이상치 민감성**: 극단적 값에 대한 과도한 영향

### 2. 주의사항

- **상관관계 ≠ 인과관계**: 상관관계가 인과관계를 의미하지 않음
- **제3의 변수**: 제3의 변수가 상관관계에 영향을 줄 수 있음
- **선형 관계**: 비선형 관계는 상관계수로 측정할 수 없음

## 결론

상관분석은 보험업계에서 위험요인 간의 관계를 파악하는 핵심 기법입니다. 특히 위험요인 분석, 손해액 예측, 보험료 산출에 직접적으로 활용할 수 있습니다.

다음 포스트에서는 회귀분석을 활용한 보험 모델링에 대해 살펴보겠습니다.

## 참고자료

- [Real Statistics - Miscellaneous](https://real-statistics.com/miscellaneous/)
- Klugman, S. A., Panjer, H. H., & Willmot, G. E. (2012). Loss Models: From Data to Decisions
- Kaas, R., Goovaerts, M., Dhaene, J., & Denuit, M. (2008). Modern Actuarial Risk Theory
