---
title: "요인 분석을 활용한 보험 위험요인 구조 파악"
date: "2025-02-19"
category: "analysis"
tags: ["요인분석", "구조파악", "보험분석"]
excerpt: "요인 분석의 이론적 배경과 보험 위험요인 구조 파악에서의 활용법을 살펴보고, 실무 적용 사례를 제공합니다."
---

요인 분석(Factor Analysis)은 보험업계에서 위험요인 간의 숨겨진 구조를 파악하는 핵심 기법입니다. 이번 포스트에서는 요인 분석의 이론적 배경과 보험 위험요인 구조 파악에서의 실무적 활용법을 자세히 살펴보겠습니다.

## 요인 분석의 정의와 목적

요인 분석은 관측된 변수들을 몇 개의 공통 요인으로 설명하는 다변량 분석 기법입니다:

### 1. 요인 분석의 목적

- **구조 파악**: 변수 간의 숨겨진 구조 파악
- **차원 축소**: 고차원 데이터를 저차원으로 축소
- **특성 추출**: 공통 특성 추출
- **해석**: 복잡한 데이터의 해석

### 2. 요인 분석의 원리

**관측 변수 = 요인 로딩 × 공통 요인 + 고유 요인**

```
X₁ = λ₁₁F₁ + λ₁₂F₂ + ... + λ₁ₘFₘ + ε₁
X₂ = λ₂₁F₁ + λ₂₂F₂ + ... + λ₂ₘFₘ + ε₂
```

여기서:
- **Xᵢ**: i번째 관측 변수
- **Fⱼ**: j번째 공통 요인
- **λᵢⱼ**: 요인 로딩
- **εᵢ**: 고유 요인

## 보험업계에서의 요인 분석 활용

### 1. 주요 활용 영역

- **위험요인 분석**: 보험 위험요인의 구조 파악
- **손해액 예측**: 요인 분석을 통한 손해액 예측
- **고객 세분화**: 고객의 위험도별 분류
- **보험료 산출**: 요인 기반 보험료 산출

### 2. 파이썬을 활용한 요인 분석

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.decomposition import FactorAnalysis
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score
import warnings
warnings.filterwarnings('ignore')

# 보험 위험요인 데이터 생성 (예시)
np.random.seed(42)
n_samples = 1000

# 위험요인들
age = np.random.normal(35, 10, n_samples)
driving_experience = np.random.normal(10, 5, n_samples)
car_value = np.random.normal(20000, 5000, n_samples)
claims_history = np.random.poisson(2, n_samples)
weather_risk = np.random.uniform(0, 1, n_samples)
road_condition = np.random.uniform(0, 1, n_samples)
time_of_day = np.random.uniform(0, 24, n_samples)
traffic_density = np.random.uniform(0, 1, n_samples)

# 손해액 (위험요인들의 선형 조합 + 노이즈)
damage_amount = (1000 + 50*age - 20*driving_experience + 0.1*car_value + 
                 200*claims_history + 500*weather_risk + 300*road_condition + 
                 10*time_of_day + 400*traffic_density + np.random.normal(0, 200, n_samples))

# 데이터프레임 생성
data = pd.DataFrame({
    'age': age,
    'driving_experience': driving_experience,
    'car_value': car_value,
    'claims_history': claims_history,
    'weather_risk': weather_risk,
    'road_condition': road_condition,
    'time_of_day': time_of_day,
    'traffic_density': traffic_density,
    'damage_amount': damage_amount
})

print("보험 위험요인 데이터 기본 통계:")
print(data.describe())
```

### 3. 요인 분석 수행

```python
def factor_analysis(data, n_components=3):
    """요인 분석"""
    
    # 특성과 타겟 분리
    X = data.drop('damage_amount', axis=1)
    y = data['damage_amount']
    
    # 데이터 정규화
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)
    
    # 요인 분석
    fa = FactorAnalysis(n_components=n_components)
    X_fa = fa.fit_transform(X_scaled)
    
    # 요인 로딩
    factor_loadings = fa.components_.T
    
    print("요인 분석 결과:")
    print(f"  요인 수: {n_components}")
    print(f"  요인 로딩:")
    for i, factor in enumerate(factor_loadings):
        print(f"    요인 {i+1}: {factor}")
    
    return fa, X_fa, factor_loadings

# 요인 분석 실행
fa, X_fa, factor_loadings = factor_analysis(data, n_components=3)
```

### 4. 요인 분석 시각화

```python
def visualize_factor_analysis(factor_loadings, X_fa, feature_names):
    """요인 분석 결과 시각화"""
    
    fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 12))
    
    # 요인 로딩 히트맵
    sns.heatmap(factor_loadings, annot=True, cmap='coolwarm', center=0, ax=ax1)
    ax1.set_title('요인 로딩 히트맵')
    ax1.set_xlabel('요인')
    ax1.set_ylabel('원본 변수')
    
    # 첫 번째와 두 번째 요인 산점도
    ax2.scatter(X_fa[:, 0], X_fa[:, 1], alpha=0.6)
    ax2.set_title('첫 번째 vs 두 번째 요인')
    ax2.set_xlabel('요인 1')
    ax2.set_ylabel('요인 2')
    ax2.grid(True, alpha=0.3)
    
    # 요인 로딩 막대그래프
    ax3.bar(range(len(factor_loadings)), factor_loadings[:, 0])
    ax3.set_title('첫 번째 요인 로딩')
    ax3.set_xlabel('원본 변수')
    ax3.set_ylabel('로딩')
    ax3.grid(True, alpha=0.3)
    
    # 요인 분산
    ax4.bar(range(len(factor_loadings)), np.var(factor_loadings, axis=1))
    ax4.set_title('요인별 분산')
    ax4.set_xlabel('요인')
    ax4.set_ylabel('분산')
    ax4.grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.show()

# 요인 분석 시각화 실행
feature_names = data.drop('damage_amount', axis=1).columns
visualize_factor_analysis(factor_loadings, X_fa, feature_names)
```

## 엑셀을 활용한 요인 분석

### 1. 기본 설정

```excel
A1: 고객ID
B1: 나이
C1: 운전경력
D1: 차량가격
E1: 사고이력
F1: 날씨위험
G1: 도로상태
H1: 시간
I1: 교통밀도
J1: 손해액

A2: =ROW()-1
B2: =RAND()*50+20
C2: =RAND()*20+1
D2: =RAND()*30000+10000
E2: =POISSON.DIST(RAND(),2,TRUE)
F2: =RAND()
G2: =RAND()
H2: =RAND()*24
I2: =RAND()
J2: =1000+50*B2-20*C2+0.1*D2+200*E2+500*F2+300*G2+10*H2+400*I2+RAND()*400-200
```

### 2. 상관계수 행렬 계산

```excel
# 상관계수 행렬
A15: 변수
B15: 나이
C15: 운전경력
D15: 차량가격
E15: 사고이력
F15: 날씨위험
G15: 도로상태
H15: 시간
I15: 교통밀도

A16: 나이
B16: =CORREL(B2:B1001,B2:B1001)
C16: =CORREL(B2:B1001,C2:C1001)
D16: =CORREL(B2:B1001,D2:D1001)
E16: =CORREL(B2:B1001,E2:E1001)
F16: =CORREL(B2:B1001,F2:F1001)
G16: =CORREL(B2:B1001,G2:G1001)
H16: =CORREL(B2:B1001,H2:H1001)
I16: =CORREL(B2:B1001,I2:I1001)
```

### 3. 요인 분석

```excel
# 요인 분석
A25: 요인
B25: 요인1
C25: 요인2
D25: 요인3

A26: 나이
B26: =FACTOR(B16:I23,3)
C26: =FACTOR(B16:I23,3)
D26: =FACTOR(B16:I23,3)
```

## 고급 분석 기법

### 1. 요인 수 선택

```python
def select_optimal_factors(data, max_factors=8):
    """최적 요인 수 선택"""
    
    # 특성과 타겟 분리
    X = data.drop('damage_amount', axis=1)
    
    # 데이터 정규화
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)
    
    # 요인 수별 설명 분산 비율
    explained_variance_ratios = []
    
    for n_factors in range(1, max_factors + 1):
        fa = FactorAnalysis(n_components=n_factors)
        fa.fit(X_scaled)
        
        # 설명 분산 비율
        explained_variance_ratio = fa.explained_variance_ratio_.sum()
        explained_variance_ratios.append(explained_variance_ratio)
    
    # 최적 요인 수 (설명 분산 비율 80% 이상)
    optimal_factors = np.argmax(np.array(explained_variance_ratios) >= 0.8) + 1
    
    print(f"최적 요인 수: {optimal_factors}")
    print(f"설명 분산 비율: {explained_variance_ratios[optimal_factors - 1]:.3f}")
    
    return optimal_factors, explained_variance_ratios

# 최적 요인 수 선택 실행
optimal_factors, explained_variance_ratios = select_optimal_factors(data)
```

### 2. 요인 회귀분석

```python
def factor_regression_analysis(data, n_factors=3):
    """요인 회귀분석"""
    
    # 특성과 타겟 분리
    X = data.drop('damage_amount', axis=1)
    y = data['damage_amount']
    
    # 데이터 정규화
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)
    
    # 요인 분석
    fa = FactorAnalysis(n_components=n_factors)
    X_fa = fa.fit_transform(X_scaled)
    
    # 훈련/테스트 데이터 분할
    X_train, X_test, y_train, y_test = train_test_split(X_fa, y, test_size=0.2, random_state=42)
    
    # 선형 회귀 모델
    model = LinearRegression()
    model.fit(X_train, y_train)
    
    # 예측
    y_pred = model.predict(X_test)
    
    # 모델 평가
    mse = mean_squared_error(y_test, y_pred)
    r2 = r2_score(y_test, y_pred)
    
    print(f"요인 회귀분석 결과:")
    print(f"  요인 수: {n_factors}")
    print(f"  MSE: {mse:.2f}")
    print(f"  R²: {r2:.3f}")
    
    return model, mse, r2

# 요인 회귀분석 실행
fa_model, fa_mse, fa_r2 = factor_regression_analysis(data, n_factors=3)
```

## 실무 적용 사례

### 사례 1: 자동차보험 위험요인 구조 분석

```python
def auto_insurance_risk_factor_structure_analysis():
    """자동차보험 위험요인 구조 분석"""
    
    # 실제 자동차보험 데이터 (예시)
    np.random.seed(42)
    n_samples = 2000
    
    # 위험요인들
    age = np.random.normal(35, 10, n_samples)
    driving_experience = np.random.normal(10, 5, n_samples)
    car_value = np.random.normal(20000, 5000, n_samples)
    claims_history = np.random.poisson(2, n_samples)
    weather_risk = np.random.uniform(0, 1, n_samples)
    road_condition = np.random.uniform(0, 1, n_samples)
    time_of_day = np.random.uniform(0, 24, n_samples)
    traffic_density = np.random.uniform(0, 1, n_samples)
    
    # 손해액 계산
    damage_amount = (1000 + 50*age - 20*driving_experience + 0.1*car_value + 
                     200*claims_history + 500*weather_risk + 300*road_condition + 
                     10*time_of_day + 400*traffic_density + np.random.normal(0, 200, n_samples))
    
    # 데이터프레임 생성
    data = pd.DataFrame({
        'age': age,
        'driving_experience': driving_experience,
        'car_value': car_value,
        'claims_history': claims_history,
        'weather_risk': weather_risk,
        'road_condition': road_condition,
        'time_of_day': time_of_day,
        'traffic_density': traffic_density,
        'damage_amount': damage_amount
    })
    
    # 요인 분석
    X = data.drop('damage_amount', axis=1)
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)
    
    fa = FactorAnalysis(n_components=3)
    X_fa = fa.fit_transform(X_scaled)
    
    # 요인 로딩 분석
    feature_names = X.columns
    factor_loadings = fa.components_.T
    
    print("자동차보험 위험요인 구조 분석 결과:")
    for i, factor in enumerate(factor_loadings):
        print(f"\n요인 {i+1}:")
        for j, feature in enumerate(feature_names):
            if abs(factor[j]) > 0.3:  # 로딩이 0.3 이상인 경우
                print(f"  {feature}: {factor[j]:.3f}")
    
    return data, fa, X_fa

# 자동차보험 위험요인 구조 분석 실행
structure_analysis = auto_insurance_risk_factor_structure_analysis()
```

### 사례 2: 보험료 산출 시스템

```python
def premium_calculation_with_factors(model, customer_data):
    """요인 분석을 통한 보험료 산출 시스템"""
    
    # 고객 데이터 정규화
    scaler = StandardScaler()
    customer_scaled = scaler.fit_transform([customer_data])
    
    # 요인 분석
    fa = FactorAnalysis(n_components=3)
    customer_fa = fa.fit_transform(customer_scaled)
    
    # 예측
    predicted_damage = model.predict(customer_fa)[0]
    
    # 보험료 계산
    base_premium = 1000
    risk_loading = predicted_damage * 0.1
    total_premium = base_premium + risk_loading
    
    return {
        'predicted_damage': predicted_damage,
        'base_premium': base_premium,
        'risk_loading': risk_loading,
        'total_premium': total_premium
    }

# 보험료 산출 시스템 실행
customer_data = [30, 5, 25000, 1, 0.7, 0.8, 14, 0.6]  # [나이, 운전경력, 차량가격, 사고이력, 날씨위험, 도로상태, 시간, 교통밀도]
premium_result = premium_calculation_with_factors(fa_model, customer_data)
for key, value in premium_result.items():
    print(f"{key}: {value}")
```

## 요인 분석의 한계와 주의사항

### 1. 요인 분석의 한계

- **선형 관계**: 비선형 관계 모델링 어려움
- **해석**: 요인의 의미 해석의 어려움
- **가정**: 정규성 가정 필요

### 2. 주의사항

- **데이터 전처리**: 데이터 정규화가 중요
- **요인 수**: 적절한 요인 수 선택
- **해석**: 요인의 의미 해석 필요

## 결론

요인 분석은 보험업계에서 위험요인 간의 숨겨진 구조를 파악하는 핵심 기법입니다. 특히 위험요인 분석, 손해액 예측, 고객 세분화에 직접적으로 활용할 수 있습니다.

다음 포스트에서는 판별 분석을 활용한 보험 모델링에 대해 살펴보겠습니다.

## 참고자료

- [Real Statistics - Miscellaneous](https://real-statistics.com/miscellaneous/)
- Klugman, S. A., Panjer, H. H., & Willmot, G. E. (2012). Loss Models: From Data to Decisions
- Kaas, R., Goovaerts, M., Dhaene, J., & Denuit, M. (2008). Modern Actuarial Risk Theory
