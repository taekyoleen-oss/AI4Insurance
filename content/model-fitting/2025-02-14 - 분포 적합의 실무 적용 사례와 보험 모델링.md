---
title: "분포 적합의 실무 적용 사례와 보험 모델링"
date: "2025-02-14"
category: "model-fitting"
tags: ["실무적용", "보험모델링", "분포적합"]
excerpt: "분포 적합의 실무 적용 사례와 보험 모델링에서의 활용법을 살펴보고, 구체적인 구현 방법을 제공합니다."
---

분포 적합은 보험업계에서 데이터 분석과 모델링의 핵심 기법입니다. 이번 포스트에서는 분포 적합의 실무 적용 사례와 보험 모델링에서의 구체적인 활용법을 자세히 살펴보겠습니다.

## 분포 적합의 실무 적용 개요

### 1. 실무 적용 단계

```
1. 데이터 수집 및 전처리
2. 탐색적 데이터 분석 (EDA)
3. 분포 후보 선정
4. 모수 추정 (MLE, 모멘트법)
5. 적합도 검정
6. 모델 선택 및 검증
7. 실무 적용 및 모니터링
```

### 2. 주요 적용 영역

- **손해액 모델링**: 보험 손해액 분포 분석
- **사고 빈도**: 사고 발생 빈도 모델링
- **생존시간**: 생명보험 생존시간 분석
- **재해 분석**: 자연재해 손해액 분포 분석

## 파이썬을 활용한 실무 적용

### 1. 종합적인 분포 적합 시스템

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats
from scipy.stats import norm, gamma, expon, weibull_min, lognorm
from sklearn.model_selection import train_test_split
import warnings
warnings.filterwarnings('ignore')

class DistributionFittingSystem:
    """분포 적합 시스템"""
    
    def __init__(self, data):
        self.data = data
        self.results = {}
        
    def fit_distributions(self, distributions=['normal', 'gamma', 'exponential', 'lognormal']):
        """여러 분포에 대한 적합"""
        
        for dist_name in distributions:
            try:
                # 분포 적합
                if dist_name == 'normal':
                    params = stats.norm.fit(self.data)
                    dist = stats.norm
                elif dist_name == 'gamma':
                    params = stats.gamma.fit(self.data)
                    dist = stats.gamma
                elif dist_name == 'exponential':
                    params = stats.expon.fit(self.data)
                    dist = stats.expon
                elif dist_name == 'lognormal':
                    params = stats.lognorm.fit(self.data)
                    dist = stats.lognorm
                elif dist_name == 'weibull':
                    params = stats.weibull_min.fit(self.data)
                    dist = stats.weibull_min
                
                # 로그우도 계산
                log_likelihood = np.sum(dist.logpdf(self.data, *params))
                
                # AIC 계산
                aic = 2 * len(params) - 2 * log_likelihood
                
                # KS 검정
                ks_stat, ks_pvalue = stats.kstest(self.data, lambda x: dist.cdf(x, *params))
                
                # AD 검정
                ad_stat, ad_critical, ad_significance = stats.anderson(self.data, dist.name)
                
                self.results[dist_name] = {
                    'params': params,
                    'log_likelihood': log_likelihood,
                    'aic': aic,
                    'ks_stat': ks_stat,
                    'ks_pvalue': ks_pvalue,
                    'ad_stat': ad_stat
                }
                
            except Exception as e:
                print(f"{dist_name} 적합 실패: {e}")
    
    def select_best_distribution(self, criterion='aic'):
        """최적 분포 선택"""
        
        if criterion == 'aic':
            best_dist = min(self.results.items(), key=lambda x: x[1]['aic'])
        elif criterion == 'ks_pvalue':
            best_dist = max(self.results.items(), key=lambda x: x[1]['ks_pvalue'])
        
        return best_dist
    
    def generate_report(self):
        """분포 적합 보고서 생성"""
        
        print("분포 적합 결과 보고서")
        print("=" * 50)
        
        for dist_name, result in self.results.items():
            print(f"\n{dist_name}:")
            print(f"  AIC: {result['aic']:.2f}")
            print(f"  KS p-value: {result['ks_pvalue']:.4f}")
            print(f"  AD 통계량: {result['ad_stat']:.4f}")
        
        # 최적 분포 선택
        best_dist = self.select_best_distribution()
        print(f"\n최적 분포: {best_dist[0]} (AIC: {best_dist[1]['aic']:.2f})")
        
        return best_dist

# 분포 적합 시스템 실행
np.random.seed(42)
damage_data = np.random.gamma(2, 1000, 1000)

fitting_system = DistributionFittingSystem(damage_data)
fitting_system.fit_distributions()
best_distribution = fitting_system.generate_report()
```

### 2. 보험 손해액 모델링

```python
def insurance_damage_modeling():
    """보험 손해액 모델링"""
    
    # 실제 보험 데이터 시뮬레이션
    np.random.seed(42)
    n_samples = 2000
    
    # 혼합분포 데이터
    normal_damage = np.random.normal(2000, 500, 1200)
    severe_damage = np.random.gamma(2, 2000, 800)
    damage_data = np.concatenate([normal_damage, severe_damage])
    
    # 분포 적합 시스템 적용
    fitting_system = DistributionFittingSystem(damage_data)
    fitting_system.fit_distributions()
    best_distribution = fitting_system.select_best_distribution()
    
    # 모델 검증
    dist_name, result = best_distribution
    
    if dist_name == 'normal':
        params = result['params']
        dist = stats.norm
    elif dist_name == 'gamma':
        params = result['params']
        dist = stats.gamma
    elif dist_name == 'exponential':
        params = result['params']
        dist = stats.expon
    elif dist_name == 'lognormal':
        params = result['params']
        dist = stats.lognorm
    
    # 예측 손해액 분포
    predicted_damage = dist.rvs(*params, size=1000)
    
    # 위험도 평가
    risk_percentile = np.percentile(predicted_damage, 95)
    expected_damage = np.mean(predicted_damage)
    
    print(f"예측 손해액 분포:")
    print(f"  평균: {expected_damage:.2f}")
    print(f"  95% 분위수: {risk_percentile:.2f}")
    
    return best_distribution, predicted_damage

# 보험 손해액 모델링 실행
best_model, predicted_damage = insurance_damage_modeling()
```

### 3. 보험료 산출 시스템

```python
def premium_calculation_system(model, customer_data):
    """보험료 산출 시스템"""
    
    dist_name, result = model
    
    # 분포 적합
    if dist_name == 'normal':
        params = result['params']
        dist = stats.norm
    elif dist_name == 'gamma':
        params = result['params']
        dist = stats.gamma
    elif dist_name == 'exponential':
        params = result['params']
        dist = stats.expon
    elif dist_name == 'lognormal':
        params = result['params']
        dist = stats.lognorm
    
    # 예측 손해액 분포
    predicted_damage = dist.rvs(*params, size=1000)
    
    # 위험도 평가
    risk_percentile = np.percentile(predicted_damage, 95)
    expected_damage = np.mean(predicted_damage)
    
    # 보험료 계산
    base_premium = expected_damage * 0.1
    risk_loading = (risk_percentile - expected_damage) * 0.05
    total_premium = base_premium + risk_loading
    
    return {
        'expected_damage': expected_damage,
        'risk_percentile': risk_percentile,
        'base_premium': base_premium,
        'risk_loading': risk_loading,
        'total_premium': total_premium
    }

# 보험료 산출 시스템 실행
customer_data = {'age': 30, 'driving_experience': 5}
premium_result = premium_calculation_system(best_model, customer_data)
for key, value in premium_result.items():
    print(f"{key}: {value:.2f}")
```

## 엑셀을 활용한 실무 적용

### 1. 기본 설정

```excel
A1: 손해액
B1: 순위
C1: 누적확률
D1: 이론적누적확률
E1: 차이

A2: =RAND()*5000+1000
B2: =RANK(A2,$A$2:$A$1001)
C2: =B2/1000
D2: =NORM.DIST(A2,AVERAGE(A2:A1001),STDEV(A2:A1001),TRUE)
E2: =ABS(C2-D2)
```

### 2. 분포 적합 함수

```excel
# 정규분포 적합
A5: 정규분포
A6: 평균
B6: =AVERAGE(A2:A1001)
A7: 표준편차
B7: =STDEV(A2:A1001)

# 감마분포 적합
A9: 감마분포
A10: 모양모수
B10: =AVERAGE(A2:A1001)^2/VAR(A2:A1001)
A11: 척도모수
B11: =VAR(A2:A1001)/AVERAGE(A2:A1001)

# 지수분포 적합
A13: 지수분포
A14: 척도모수
B14: =AVERAGE(A2:A1001)
```

### 3. 적합도 검정

```excel
# Kolmogorov-Smirnov 검정
A17: KS 통계량
B17: =MAX(E2:E1001)
A18: 임계값
B18: =1.36/SQRT(1000)
A19: 검정결과
B19: =IF(B17>B18,"기각","수용")

# Chi-square 검정
A22: 구간
B22: 관측빈도
C22: 기댓값
D22: Chi-square

A23: 0-1000
B23: =COUNTIF(A2:A1001,"<=1000")
C23: =NORM.DIST(1000,B6,B7,TRUE)*1000
D23: =(B23-C23)^2/C23
```

## 고급 분석 기법

### 1. 시계열 분포 적합

```python
def time_series_distribution_fitting(data, window_size=100):
    """시계열 분포 적합"""
    
    results = []
    
    for i in range(0, len(data) - window_size + 1, window_size):
        window_data = data[i:i + window_size]
        
        # 분포 적합
        fitting_system = DistributionFittingSystem(window_data)
        fitting_system.fit_distributions()
        best_dist = fitting_system.select_best_distribution()
        
        results.append({
            'window': i,
            'best_distribution': best_dist[0],
            'aic': best_dist[1]['aic'],
            'ks_pvalue': best_dist[1]['ks_pvalue']
        })
    
    return results

# 시계열 분포 적합 실행
time_series_data = np.random.gamma(2, 1000, 1000)
time_series_results = time_series_distribution_fitting(time_series_data)
```

### 2. 혼합분포 모델링

```python
def mixture_distribution_modeling(data, n_components=2):
    """혼합분포 모델링"""
    
    from sklearn.mixture import GaussianMixture
    
    # 데이터 정규화
    data_normalized = (data - np.mean(data)) / np.std(data)
    
    # 혼합분포 모델 적합
    gmm = GaussianMixture(n_components=n_components, random_state=42)
    gmm.fit(data_normalized.reshape(-1, 1))
    
    # 모델 파라미터
    means = gmm.means_.flatten() * np.std(data) + np.mean(data)
    covariances = gmm.covariances_.flatten() * np.var(data)
    weights = gmm.weights_
    
    print("혼합분포 모델 파라미터:")
    for i, (mean, cov, weight) in enumerate(zip(means, covariances, weights)):
        print(f"성분 {i+1}: 평균={mean:.2f}, 분산={cov:.2f}, 가중치={weight:.3f}")
    
    return gmm, means, covariances, weights

# 혼합분포 모델링 실행
mixture_data = np.concatenate([
    np.random.normal(1000, 200, 600),
    np.random.normal(3000, 500, 400)
])
gmm, means, covariances, weights = mixture_distribution_modeling(mixture_data)
```

## 실무 적용 사례

### 사례 1: 자동차보험 손해액 분석

```python
def auto_insurance_damage_analysis():
    """자동차보험 손해액 분석"""
    
    # 실제 자동차보험 데이터 (예시)
    np.random.seed(42)
    n_samples = 3000
    
    # 혼합분포 데이터
    normal_damage = np.random.normal(1500, 300, 1800)
    moderate_damage = np.random.gamma(2, 1000, 800)
    severe_damage = np.random.gamma(3, 2000, 400)
    damage_data = np.concatenate([normal_damage, moderate_damage, severe_damage])
    
    # 분포 적합 시스템 적용
    fitting_system = DistributionFittingSystem(damage_data)
    fitting_system.fit_distributions()
    best_distribution = fitting_system.select_best_distribution()
    
    # 모델 검증
    dist_name, result = best_distribution
    
    if dist_name == 'normal':
        params = result['params']
        dist = stats.norm
    elif dist_name == 'gamma':
        params = result['params']
        dist = stats.gamma
    elif dist_name == 'exponential':
        params = result['params']
        dist = stats.expon
    elif dist_name == 'lognormal':
        params = result['params']
        dist = stats.lognorm
    
    # 예측 손해액 분포
    predicted_damage = dist.rvs(*params, size=1000)
    
    # 위험도 평가
    risk_percentile = np.percentile(predicted_damage, 95)
    expected_damage = np.mean(predicted_damage)
    
    print(f"자동차보험 손해액 분석 결과:")
    print(f"  최적 분포: {dist_name}")
    print(f"  예측 평균: {expected_damage:.2f}")
    print(f"  95% 분위수: {risk_percentile:.2f}")
    
    return best_distribution, predicted_damage

# 자동차보험 손해액 분석 실행
auto_analysis = auto_insurance_damage_analysis()
```

### 사례 2: 생명보험 생존시간 분석

```python
def life_insurance_survival_analysis():
    """생명보험 생존시간 분석"""
    
    # 실제 생명보험 데이터 (예시)
    np.random.seed(42)
    n_samples = 2000
    
    # 생존시간 데이터 (Weibull 분포)
    shape = 2.0
    scale = 1000.0
    survival_data = np.random.weibull(shape, n_samples) * scale
    
    # 분포 적합 시스템 적용
    fitting_system = DistributionFittingSystem(survival_data)
    fitting_system.fit_distributions(['weibull', 'gamma', 'exponential', 'lognormal'])
    best_distribution = fitting_system.select_best_distribution()
    
    # 모델 검증
    dist_name, result = best_distribution
    
    if dist_name == 'weibull':
        params = result['params']
        dist = stats.weibull_min
    elif dist_name == 'gamma':
        params = result['params']
        dist = stats.gamma
    elif dist_name == 'exponential':
        params = result['params']
        dist = stats.expon
    elif dist_name == 'lognormal':
        params = result['params']
        dist = stats.lognorm
    
    # 예측 생존시간 분포
    predicted_survival = dist.rvs(*params, size=1000)
    
    # 위험도 평가
    risk_percentile = np.percentile(predicted_survival, 95)
    expected_survival = np.mean(predicted_survival)
    
    print(f"생명보험 생존시간 분석 결과:")
    print(f"  최적 분포: {dist_name}")
    print(f"  예측 평균: {expected_survival:.2f}")
    print(f"  95% 분위수: {risk_percentile:.2f}")
    
    return best_distribution, predicted_survival

# 생명보험 생존시간 분석 실행
life_analysis = life_insurance_survival_analysis()
```

## 분포 적합의 한계와 대안

### 1. 분포 적합의 한계

- **분포 가정**: 특정 분포 형태 가정 필요
- **모수 추정**: 제한된 모수로 복잡한 분포 모델링 어려움
- **이상치 민감성**: 극단적 값에 대한 과도한 영향

### 2. 대안 방법들

- **비모수 방법**: 분포 가정 없이 데이터 분석
- **머신러닝**: 랜덤포레스트, 신경망
- **베이지안 방법**: 불확실성 정량화
- **앙상블**: 여러 분포의 조합

## 결론

분포 적합은 보험업계에서 데이터 분석과 모델링의 핵심 기법입니다. 특히 손해액 예측, 리스크 평가, 보험료 산출에 직접적으로 활용할 수 있습니다.

다음 포스트에서는 다른 분포 적합 기법들을 활용한 보험 모델링에 대해 살펴보겠습니다.

## 참고자료

- [Real Statistics - Distribution Fitting](https://real-statistics.com/distribution-fitting/)
- Klugman, S. A., Panjer, H. H., & Willmot, G. E. (2012). Loss Models: From Data to Decisions
- Kaas, R., Goovaerts, M., Dhaene, J., & Denuit, M. (2008). Modern Actuarial Risk Theory
